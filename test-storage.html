<!DOCTYPE html>
<html>
<head>
    <title>Storage Test</title>
</head>
<body>
    <h1>Storage Test</h1>
    <button onclick="testStorage()">Test Storage</button>
    <button onclick="clearStorage()">Clear Storage</button>
    <button onclick="showStorage()">Show Storage</button>
    <pre id="output"></pre>
    
    <script src="js/storage.js"></script>
    <script>
        const storage = new StorageModule();
        const output = document.getElementById('output');
        
        function showStorage() {
            const data = storage.getData();
            output.textContent = JSON.stringify(data, null, 2);
        }
        
        function clearStorage() {
            localStorage.clear();
            storage.init();
            showStorage();
        }
        
        function testStorage() {
            // Test saving a project
            const beatPattern = [
                {'beat': 'kick', 'dur': 1, 'vol': [0.8]},
                {'beat': 'snare', 'dur': 1, 'vol': [0.6]}
            ];
            
            const melodyPattern = [
                {'note': 'C4', 'dur': 1, 'vol': [0.7], 'instrument': 'piano'},
                {'note': 'E4', 'dur': 1, 'vol': [0.6], 'instrument': 'piano'}
            ];
            
            const result = storage.saveProject('Test Project', beatPattern, melodyPattern, {
                tempo: 140,
                playbackMode: 'both'
            });
            
            console.log('Save result:', result);
            
            // Test getting projects
            const projects = storage.getProjects();
            console.log('Projects:', projects);
            
            // Test export
            const exportData = storage.exportData();
            console.log('Export data:', exportData);
            
            showStorage();
        }
        
        showStorage();
    </script>
</body>
</html>